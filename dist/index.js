(function(){"use strict";try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode("._outter_1ymef_4{position:fixed;top:0;left:0;z-index:1000;width:0;height:0;all:initial;font-family:system-ui,sans-serif;font-size:1rem}@media (prefers-color-scheme: dark){._outter_1ymef_4 *{--color-base-0: rgb(0, 0, 0);--color-base-100: #171717;--color-base-200: #343434;--color-base-content: #c2c2c2;--color-primary: rgb(1, 136, 127);--color-primary-content: rgb(227, 218, 237)}}@media (prefers-color-scheme: light){._outter_1ymef_4 *{--color-base-0: rgb(255, 255, 255);--color-base-100: #e9e9e9;--color-base-200: #c9c9c9;--color-base-content: #171717;--color-primary: rgb(3, 187, 175);--color-primary-content: rgb(227, 218, 237)}}._backdrop_1ymef_47{background:rgb(from var(--color-base-0) r g b / 60%);width:100vw;height:100vh;position:fixed;top:0;left:0;backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);z-index:1000}._container_1ymef_59{position:fixed;top:0;left:0;width:100vw;height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center;color:var(--color-base-content);z-index:1001}._container_1ymef_59 button{--color-border: var(--color-base-200);--color-bg: rgb(from var(--color-base-200) r g b / 60%);--color-text: var(--color-base-content);border:none;cursor:pointer;background:transparent;padding:.5em 1em;box-sizing:border-box;color:var(--color-text);transition:all;transition-duration:.15s}._container_1ymef_59 button:hover{--color-border: var(--color-base-200);--color-bg: rgb(from var(--color-base-0) r g b / 100%);--color-text: var(--color-base-content)}._container_1ymef_59 button:disabled{opacity:50%}._container_1ymef_59 button._btn_1ymef_92{background-color:var(--color-bg);color:var(--color-text);border:solid 1px var(--color-border);padding:.5em 1em;border-radius:.4em;display:inline-flex;justify-content:center;align-items:center}._container_1ymef_59 a{color:var(--color-primary)}._container_1ymef_59 a:hover{color:var(--color-base-content);text-decoration:underline}input{border:solid 1px var(--color-border);color:var(--color-text)}._outter_1ymef_4,._container_1ymef_59,._content_1ymef_120,._backdrop_1ymef_47{transition:all;transition-duration:.15s}._content_1ymef_120{max-width:320px;width:320px;background-color:rgb(from var(--color-base-100) r g b / 60%);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);display:block;box-sizing:border-box;border-radius:1em;box-shadow:0 14px 47px -13px #0000000d;-webkit-box-shadow:0px 14px 47px -13px rgba(0,0,0,.05);-moz-box-shadow:0px 14px 47px -13px rgba(0,0,0,.05);border:solid 1px rgb(from var(--color-base-200) r g b / 60%)}._content_1ymef_120 ._head_1ymef_139{display:flex;width:100%;justify-content:space-between;align-items:center;padding:1em;box-sizing:border-box}._content_1ymef_120 ._main_1ymef_147{padding:1em 1.5em}._content_1ymef_120 ._foot_1ymef_150{padding:.5em 1em 1.5em;text-align:center;display:flex;justify-content:space-between;align-items:center}._content_1ymef_120 h3{font-size:1.1rem;line-height:1.2rem;padding:0;margin:0}._content_1ymef_120:hover{border:solid 1px rgb(from var(--color-base-200) r g b / 100%)}._captchabox_1ymef_171{display:flex;background-color:var(--color-base-200);justify-content:center;align-items:center;gap:.5em;padding:.5em;border-radius:.5em;width:100%}._svgbox_1ymef_182{width:fit-content}._svgbox_1ymef_182 svg{width:1em;object-fit:contain}")),document.head.appendChild(e)}}catch(o){console.error("vite-plugin-css-injected-by-js",o)}})();
"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const s=require("solid-js/web"),ot=require("@permaweb/aoconnect/browser"),m=require("solid-js");function q(a){return a!=null&&typeof a=="object"&&a["@@functional/placeholder"]===!0}function T(a){return function t(e){return arguments.length===0||q(e)?t:a.apply(this,arguments)}}function lt(a){return function t(e,r){switch(arguments.length){case 0:return t;case 1:return q(e)?t:T(function(n){return a(e,n)});default:return q(e)&&q(r)?t:q(e)?T(function(n){return a(n,r)}):q(r)?T(function(n){return a(e,n)}):a(e,r)}}}function V(a,t){return Object.prototype.hasOwnProperty.call(t,a)}var tt=Object.prototype.toString,ct=function(){return tt.call(arguments)==="[object Arguments]"?function(t){return tt.call(t)==="[object Arguments]"}:function(t){return V("callee",t)}}(),ut=!{toString:null}.propertyIsEnumerable("toString"),et=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],rt=function(){return arguments.propertyIsEnumerable("length")}(),ht=function(t,e){for(var r=0;r<t.length;){if(t[r]===e)return!0;r+=1}return!1},dt=T(typeof Object.keys=="function"&&!rt?function(t){return Object(t)!==t?[]:Object.keys(t)}:function(t){if(Object(t)!==t)return[];var e,r,n=[],u=rt&&ct(t);for(e in t)V(e,t)&&(!u||e!=="length")&&(n[n.length]=e);if(ut)for(r=et.length-1;r>=0;)e=et[r],V(e,t)&&!ht(n,e)&&(n[n.length]=e),r-=1;return n}),mt=lt(function(t,e){for(var r={},n={},u=0,c=t.length;u<c;)n[t[u]]=1,u+=1;for(var l in e)n.hasOwnProperty(l)||(r[l]=e[l]);return r});const pt={goldsky:"https://arweave-search.goldsky.com/graphql"},nt="https://workshop.forward.computer",st=pt.goldsky,yt=a=>{const t="ans104";return async({data:e,tags:r,target:n,anchor:u})=>{let c,l;const h=new Promise(o=>{c=o});return a(async o=>{if(l=!0,o.passthrough)return{data:e,tags:r,target:n,anchor:u};const{publicKey:f,type:p=1,alg:b="rsa-v1_5-sha256"}=o,P=createDataItemBytes(e,{type:p,publicKey:toView(f)},{target:n,tags:r,anchor:u});return c(P),await getSignatureData(P)},t).then(o=>{if(!l)throw new Error("create() must be invoked in order to construct the data to sign");if(typeof o=="object"&&o.id&&o.raw)return o;if(!o.signature||!o.signature)throw new Error("signer must return its signature and address");const{signature:f}=o;return h.then(p=>Promise.resolve(f).then(toView).then(async b=>{const P=p;if(P.set(b,2),!await verify(P))throw new Error("Data Item signature is not valid");return{id:await crypto.subtle.digest("SHA-256",b).then(v=>base64url.encode(v)),raw:P}}))})}};function ft(a){const t={target:a.target,anchor:a.anchor??"",tags:dt(mt(["Target","target","Anchor","anchor","Data","data","data-protocol","Data-Protocol","variant","Variant","dryrun","Dryrun","Type","type","path","method","signingFormat","signing-format"],a)).map(function(e){return{name:e,value:a[e]}},a).concat([{name:"data-protocol",value:"ao"},{name:"type",value:a.type??"Message"},{name:"variant",value:a.variant??"ao.N.1"}]),data:a?.data||""};return{headers:{"Content-Type":"application/ans104","codec-device":"ans104@1.0","accept-bundle":"true"},item:t}}class at{constructor(t={}){const{url:e=nt,wallet:r,gql_url:n=st}=t;this.url=e||nt,this.wallet=r,this.gql_url=n||st}fetch=function(t,e){return fetch(this.url+t,e).then(r=>r?.ok&&r?.json())};send=async function(t,e){try{let{target:r}=t;if(!r)throw new Error("Missed target process");let n=ot.createSigner(e||this.wallet);if(!n)throw new Error("Missed singer");t["Data-Protocol"]="ao",t.Variant="ao.N.1",t.signingFormat=t.signingFormat||"ANS-104";const u=ft(t),c=await yt(n)(u.item);console.log("signedRequest: ",c?.id);let l=this.url,h=`/${r}~process@1.0/push/serialize~json@1.0`,d={body:c.raw,url:l+h,path:h,method:"POST",headers:u.headers};const o=await fetch(d.url,{method:d.method,headers:d.headers,body:d.body,redirect:"follow"});if(o.status==500)throw new Error(`${o.status}: ${await o.text()}`);if(o.status===404)throw new Error(`${o.status}: ${await o.text()}`);if(o.status>=400)throw new Error(`${o.status}: ${await o.text()}`);if(o.status>=300)return o;const f=await o.json();return{id:c?.id,...f}}catch(r){throw r}}}const vt="_outter_1ymef_4",gt="_backdrop_1ymef_47",wt="_container_1ymef_59",bt="_btn_1ymef_92",_t="_content_1ymef_120",Ct="_head_1ymef_139",Pt="_main_1ymef_147",xt="_foot_1ymef_150",kt="_captchabox_1ymef_171",St="_svgbox_1ymef_182",w={outter:vt,backdrop:gt,container:wt,btn:bt,content:_t,head:Ct,main:Pt,foot:xt,captchabox:kt,svgbox:St};var At=s.template('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"><g fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=1.7><path stroke-dasharray=16 stroke-dashoffset=16 d="M12 3c4.97 0 9 4.03 9 9"><animate fill=freeze attributeName=stroke-dashoffset dur=0.645s values=16;0></animate><animateTransform attributeName=transform dur=3.225s repeatCount=indefinite type=rotate values="0 12 12;360 12 12"></animateTransform></path><path stroke-dasharray=64 stroke-dashoffset=64 stroke-opacity=0.3 d="M12 3c4.97 0 9 4.03 9 9c0 4.97 -4.03 9 -9 9c-4.97 0 -9 -4.03 -9 -9c0 -4.97 4.03 -9 9 -9Z"><animate fill=freeze attributeName=stroke-dashoffset dur=2.58s values=64;0>');const it=a=>(()=>{var t=At();return s.effect(e=>{var r=a?.size||"1em",n=a?.size||"1em";return r!==e.e&&((e.e=r)!=null?t.style.setProperty("width",r):t.style.removeProperty("width")),n!==e.t&&((e.t=n)!=null?t.style.setProperty("height",n):t.style.removeProperty("height")),e},{e:void 0,t:void 0}),t})(),qt=a=>{let t;const[e,r]=m.createSignal(),n=m.createMemo(()=>{let c=Math.floor(e()/60/60/24).toString().padStart(2,"0"),l=Math.floor(e()/60/60%24).toString().padStart(2,"0"),h=Math.floor(e()/60%60).toString().padStart(2,"0"),d=Math.floor(e()%60).toString().padStart(2,"0");return c!="00"?`${c}:${l}:${h}:${d}`:`${l}:${h}:${d}`}),u=()=>{const c=Date.now(),l=(a?.end-c)/1e3;r(l),t=requestAnimationFrame(u)};return m.createEffect(()=>{t=requestAnimationFrame(u),m.onCleanup(()=>cancelAnimationFrame(t)),e()&&e()<=0&&a?.onTimeout&&a?.onTimeout(e())}),s.memo(n)};var Et=s.template('<svg viewBox="0 0 277 277"fill=none xmlns=http://www.w3.org/2000/svg><path fill-rule=evenodd clip-rule=evenodd d="M119.455 25.881C127.686 10.0406 150.326 10.0388 158.556 25.881L265.485 231.76C273.113 246.446 262.469 264 245.935 264H32.0652C15.5311 264 4.88687 246.446 12.5149 231.76L119.455 25.881ZM139.005 98.5468C132.92 98.5468 127.988 103.485 127.988 109.577V155.615C115.155 160.161 105.952 172.385 105.952 186.789C105.952 205.064 120.751 219.879 139.005 219.879C157.259 219.877 172.059 205.063 172.059 186.789C172.059 172.386 162.854 160.162 150.023 155.615V109.577C150.023 103.486 145.089 98.5486 139.005 98.5468Z"fill=currentColor>');const Rt=a=>(()=>{var t=Et();return t.style.setProperty("height","1em"),t})();var $t=s.template("<span>Verifying..."),Tt=s.template("<span>AoCaptcha"),Nt=s.template('<div id=ao-captcha-sdk><div><div><div><p></p><button><svg xmlns=http://www.w3.org/2000/svg width=1em height=1em viewBox="0 0 24 24"><path fill=currentColor d="M5.293 5.293a1 1 0 0 1 1.414 0L12 10.586l5.293-5.293a1 1 0 1 1 1.414 1.414L13.414 12l5.293 5.293a1 1 0 0 1-1.414 1.414L12 13.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L10.586 12L5.293 6.707a1 1 0 0 1 0-1.414"></path></svg></button></div><div><div></div><div>Expired in:</div></div><div><input placeholder="input the code above"type=text required><button></button></div></div></div><div>'),Lt=s.template("<div>loading..."),Mt=s.template("<div><svg xmlns=http://www.w3.org/2000/svg><path fill=currentColor>"),Dt=s.template('<svg xmlns=http://www.w3.org/2000/svg width=2em height=2em viewBox="0 0 24 24"><path fill=none stroke=currentColor stroke-dasharray=24 stroke-dashoffset=24 stroke-linecap=round stroke-linejoin=round stroke-width=1.7 d="M5 11l6 6l10 -10"><animate fill=freeze attributeName=stroke-dashoffset dur=0.86s values=24;0>');function Ut(a){let t=null,e=null;const[r,n]=m.createSignal(),[u,c]=m.createSignal(!1),[l,h]=m.createSignal(!1),[d,o]=m.createSignal(),[f,p]=m.createSignal(),b=m.createMemo(()=>r()!=null&&f()!=null&&f()?.length==(r()?.digits||3)),P=()=>{b()&&(h(!0),t(f()).then(y=>m.batch(()=>{c(!1),p(null)})).catch(y=>{console.error(y),o("verify failed"),c(!1)}).finally(()=>h(!1)))};return m.onMount(()=>{a?.ref({show:(y,v,N)=>{t=v,e=N,m.batch(()=>{h(!1),n(y),p(null),o(null),c(!0)})},close:y=>{c(!1)}})}),m.onCleanup(()=>{console.log("aocaptcha is removed")}),s.createComponent(s.Portal,{get children(){var y=Nt(),v=y.firstChild,N=v.firstChild,M=N.firstChild,x=M.firstChild,z=x.nextSibling,D=M.nextSibling,U=D.firstChild,E=U.nextSibling;E.firstChild;var B=D.nextSibling,_=B.firstChild,C=_.nextSibling,I=v.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justifyContent","start"),x.style.setProperty("alignItems","center"),x.style.setProperty("gap","0.5em"),s.insert(x,s.createComponent(m.Switch,{get children(){return[s.createComponent(m.Match,{get when(){return l()},get children(){return[s.createComponent(it,{})," ",$t()]}}),s.createComponent(m.Match,{get when(){return!l()},get children(){return[s.createComponent(Rt,{})," ",Tt()]}})]}})),z.$$click=()=>{c(!1),e()},s.insert(U,s.createComponent(m.For,{get each(){return r()?.paths},get fallback(){return Lt()},children:i=>(()=>{var k=Mt(),S=k.firstChild,L=S.firstChild;return s.effect(g=>{var A=w.svgbox,R=i?.[0],$=i?.[1];return A!==g.e&&s.className(k,g.e=A),R!==g.t&&s.setAttribute(S,"viewBox",g.t=R),$!==g.a&&s.setAttribute(L,"d",g.a=$),g},{e:void 0,t:void 0,a:void 0}),k})()})),E.style.setProperty("font-size","0.8em"),E.style.setProperty("text-align","center"),E.style.setProperty("padding-top","0.2em"),s.insert(E,s.createComponent(qt,{get end(){return r()?.timestamp+r()?.duration}}),null),_.$$input=i=>{p(i.target.value)},_.style.setProperty("padding","4px 4px 4px 4px"),_.style.setProperty("min-width","20px"),_.style.setProperty("min-width","5em"),_.style.setProperty("font-size","1.2em"),C.$$click=P,C.style.setProperty("--color-border","var(--color-primary)"),C.style.setProperty("--color-bg","var(--color-primary)"),C.style.setProperty("--color-text","var(--color-primary-content)"),C.style.setProperty("border-radius","100% 100% 100% 100%"),C.style.setProperty("width","3em"),C.style.setProperty("height","3em"),s.insert(C,(()=>{var i=s.memo(()=>!!l());return()=>i()?s.createComponent(it,{size:"2em"}):Dt()})()),s.effect(i=>{var k=w.outter,S=`${u()?"visible":"hidden"}`,L=w.container,g=`${u()?"0% 0%":"0% 50%"}`,A=`${u()?"100":"0"}`,R=w.content,$=w.head,H=l(),G=w.main,W=w.captchabox,Y=w.foot,K=w.input,Z=r()?.digits||3,J=l(),Q=w.btn,j=!b(),X=w.backdrop,O=`${u()?"100":"0"}`;return k!==i.e&&s.className(y,i.e=k),S!==i.t&&((i.t=S)!=null?y.style.setProperty("visibility",S):y.style.removeProperty("visibility")),L!==i.a&&s.className(v,i.a=L),g!==i.o&&((i.o=g)!=null?v.style.setProperty("translate",g):v.style.removeProperty("translate")),A!==i.i&&((i.i=A)!=null?v.style.setProperty("opacity",A):v.style.removeProperty("opacity")),R!==i.n&&s.className(N,i.n=R),$!==i.s&&s.className(M,i.s=$),H!==i.h&&(z.disabled=i.h=H),G!==i.r&&s.className(D,i.r=G),W!==i.d&&s.className(U,i.d=W),Y!==i.l&&s.className(B,i.l=Y),K!==i.u&&s.className(_,i.u=K),Z!==i.c&&s.setAttribute(_,"minlength",i.c=Z),J!==i.w&&(_.disabled=i.w=J),Q!==i.m&&s.className(C,i.m=Q),j!==i.f&&(C.disabled=i.f=j),X!==i.y&&s.className(I,i.y=X),O!==i.g&&((i.g=O)!=null?I.style.setProperty("opacity",O):I.style.removeProperty("opacity")),i},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),s.effect(()=>_.value=f()),y}})}s.delegateEvents(["click","input"]);let F;s.render(()=>s.createComponent(Ut,{ref(a){var t=F;typeof t=="function"?t(a):F=a}}),document.body);class It{constructor(t,e){this.process=t,this.recipient=e?.recipient||e?.Recipient,this.type=e?.type||e?.Type||"DEFAULT",this.wallet=e?.wallet||e?.Wallet,this.latest_request=null,this.MU_URL=e?.ao?.MU_URL||"https://mu.ao-testnet.xyz",this.CU_URL=e?.ao?.CU_URL||"https://cu.ao-testnet.xyz",this.GATEWAY_URL=e?.ao?.GATEWAY_URL||"https://arweave.net",this.MODE=e?.ao?.GATEWAY_URL||"legacy",this.URL="http://node.arweaveoasis.com:8734"}m=async(t,e,r)=>{try{return this.wallet||reject("missed wallet"),this.hb=new at({url:this.URL,wallet:this.wallet}),await this.hb.send({target:t,data:r||"",...e},this.wallet)}catch(n){throw n}};getLatestRequest(){return this.latest_request}request(t,e){return new Promise(async(r,n)=>{const u=Date.now();if(this.wallet=e||this.wallet,this.recipient=t.recipient||t.Recipient||this.recipient,this.type=t["Request-Type"]||t?.type||t?.Type||this.type||"DEFAULT",this.process||n("missed the captcha process id"),this.recipient||n("missed the request process id"),this.wallet||n("missed wallet"),this.latest_request&&u-this.latest_request?.timestamp<this.latest_request.duration){r(this.latest_request);return}t.Action="Request-Captcha",t.Recipient=t.Recipient||this.recipient,t["Request-Type"]=t["Request-Type"]||this.type;const{id:c,outbox:l}=await this.m(this.process,t,"a aocaptcha request").catch(h=>n(h));if(l?.["1"]){const{Data:h,...d}=l?.["1"],o={id:c,paths:h&&JSON.parse(h),timestamp:Number(d["Request-Time"]),duration:Number(d["Request-Duration"]),type:d["Captcha-Type"],digits:Number(d["Captcha-Digits"]),request_type:d["Request-Type"],recipient:this.recipient};console.log("request sucessed: ",c),this.latest_request=o,r(o)}else throw new Error("fetch captcha faild.")})}verify(t,e){return new Promise(async(r,n)=>{const u=Date.now();this.wallet=e||this.wallet,this.process||n("missed the captcha process id"),t||n("missed request data."),t.paths||n("missed captcha data."),(!t.timestamp||t?.timestamp+t?.duration<u)&&n("the captcha is expired."),!this.wallet&&!e&&n("missed wallet"),F.show(t,async c=>{try{const l={Action:"Verify-Captcha","Request-Id":t?.id,"Pushed-For":t?.id,"App-Name":"AoCaptcha"},{id:h,outbox:d}=await this.m(this.process,l,c).catch(p=>n(p)),f=await(this.hb||new at({url:this.URL})).fetch(`/${t?.recipient}~process@1.0/compute&id=${h}/results/serialize~json@1.0`);if(d?.["1"]){const p=d?.["1"],b={id:p["Verify-Id"]||h,request_id:p["Request-Id"],request_time:p["Request-Time"],request_type:p["Request-Type"],verified_time:p["Verified-Time"],verified:!0,result:f};return console.log("verify sucessed: ",b?.id),this.latest_request=null,r(b),b}else throw n("verify failed"),this.latest_request=null,"failed"}catch(l){throw l}},()=>{n("cancelled")})})}}exports.AoCaptcha=It;
